CREATE DATABASE ecommerce_db;

USE ecommerce_db;

CREATE TABLE customers (
 customer_id INT,
 customer_name VARCHAR(50),
 email VARCHAR(50),
 city VARCHAR(50),
 signup_date DATE
);

CREATE TABLE PRODUCTS (
 product_id INT,
 product_name VARCHAR(100),
 category VARCHAR(50),
 price DECIMAL(10,2)
);

CREATE TABLE orders (
 order_id INT,
 customer_id INT,
 order_date DATE
);

CREATE TABLE order_items(
 order_item_id INT,
 order_id INT,
 product_id INT,
 quantity INT,
 price DECIMAL(10,2)
);

CREATE TABLE payments (
 payment_id INT,
 order_id INT,
 payment_mode VARCHAR(20),
 payment_status VARCHAR(20)
);

INSERT INTO customers (customer_id, customer_name, email, city, signup_date) VALUES
(1,'Amit Sharma','amit1@gmail.com','Delhi','2023-01-10'),
(2,'Neha Verma','neha2@gmail.com','Mumbai','2023-01-12'),
(3,'Rohit Singh','rohit3@gmail.com','Pune','2023-01-15'),
(4,'Priya Patel','priya4@gmail.com','Ahmedabad','2023-01-18'),
(5,'Karan Mehta','karan5@gmail.com','Surat','2023-01-20'),
(6,'Anjali Shah','anjali6@gmail.com','Rajkot','2023-01-22'),
(7,'Rahul Jain','rahul7@gmail.com','Indore','2023-01-25'),
(8,'Simran Kaur','simran8@gmail.com','Chandigarh','2023-01-28'),
(9,'Vikas Yadav','vikas9@gmail.com','Noida','2023-02-01'),
(10,'Pooja Gupta','pooja10@gmail.com','Gurgaon','2023-02-05'),
(11,'Aman Arora','aman11@gmail.com','Delhi','2023-02-10'),
(12,'Nikita Joshi','nikita12@gmail.com','Jaipur','2023-02-12'),
(13,'Suresh Patel','suresh13@gmail.com','Surat','2023-02-15'),
(14,'Riya Malhotra','riya14@gmail.com','Mumbai','2023-02-18'),
(15,'Arjun Kapoor','arjun15@gmail.com','Delhi','2023-02-20'),
(16,'Manish Kumar','manish16@gmail.com','Patna','2023-02-22'),
(17,'Neel Shah','neel17@gmail.com','Ahmedabad','2023-02-25'),
(18,'Kavita Joshi','kavita18@gmail.com','Udaipur','2023-02-28'),
(19,'Vivek Singh','vivek19@gmail.com','Lucknow','2023-03-01'),
(20,'Ritu Malhotra','ritu20@gmail.com','Chandigarh','2023-03-03'),
(21,'Sahil Verma','sahil21@gmail.com','Noida','2023-03-05'),
(22,'Meena Patel','meena22@gmail.com','Vadodara','2023-03-07'),
(23,'Deepak Yadav','deepak23@gmail.com','Kanpur','2023-03-10'),
(24,'Sneha Kulkarni','sneha24@gmail.com','Pune','2023-03-12'),
(25,'Nikhil Jain','nikhil25@gmail.com','Indore','2023-03-15'),
(26,'Aarti Singh','aarti26@gmail.com','Bhopal','2023-03-18'),
(27,'Harsh Mehta','harsh27@gmail.com','Surat','2023-03-20'),
(28,'Pankaj Sharma','pankaj28@gmail.com','Jaipur','2023-03-22'),
(29,'Riya Sen','riya29@gmail.com','Kolkata','2023-03-25'),
(30,'Mohit Agarwal','mohit30@gmail.com','Agra','2023-03-28'),
(31,'Shubham Verma','shubham31@gmail.com','Meerut','2023-04-01'),
(32,'Tanvi Joshi','tanvi32@gmail.com','Pune','2023-04-03'),
(33,'Aakash Jain','aakash33@gmail.com','Bhopal','2023-04-05'),
(34,'Pallavi Patil','pallavi34@gmail.com','Nagpur','2023-04-07'),
(35,'Yash Malhotra','yash35@gmail.com','Delhi','2023-04-10'),
(36,'Komal Saxena','komal36@gmail.com','Gwalior','2023-04-12'),
(37,'Nitin Kapoor','nitin37@gmail.com','Faridabad','2023-04-15'),
(38,'Shweta Rao','shweta38@gmail.com','Bangalore','2023-04-18'),
(39,'Ankit Mishra','ankit39@gmail.com','Prayagraj','2023-04-20'),
(40,'Divya Choudhary','divya40@gmail.com','Jaipur','2023-04-22'),
(41,'Rohit Bansal','rohit41@gmail.com','Panipat','2023-04-25'),
(42,'Sonal Shah','sonal42@gmail.com','Surat','2023-04-27'),
(43,'Prateek Sinha','prateek43@gmail.com','Ranchi','2023-04-29'),
(44,'Kiran Patil','kiran44@gmail.com','Nashik','2023-05-01'),
(45,'Amit Yadav','amit45@gmail.com','Azamgarh','2023-05-03'),
(46,'Neha Arora','neha46@gmail.com','Rohtak','2023-05-05'),
(47,'Varun Jain','varun47@gmail.com','Ujjain','2023-05-07'),
(48,'Pooja Desai','pooja48@gmail.com','Valsad','2023-05-10'),
(49,'Rakesh Meena','rakesh49@gmail.com','Kota','2023-05-12'),
(50,'Isha Kapoor','isha50@gmail.com','Delhi','2023-05-15');


INSERT INTO products (product_id, product_name, category, price) VALUES
(101,'Wireless Mouse','Electronics',799),
(102,'Bluetooth Headphones','Electronics',1999),
(103,'Laptop Backpack','Accessories',1499),
(104,'Smart Watch','Electronics',3499),
(105,'Water Bottle','Home',499),
(106,'USB Keyboard','Electronics',899),
(107,'Office Chair','Furniture',5999),
(108,'Notebook Pack','Stationery',299),
(109,'Desk Lamp','Home',1299),
(110,'Power Bank','Electronics',1599),
(111,'Bluetooth Speaker','Electronics',2499),
(112,'Webcam','Electronics',1899),
(113,'Pen Drive 64GB','Electronics',699),
(114,'Table Fan','Appliances',2499),
(115,'Laptop Stand','Accessories',1199),
(116,'Gaming Mouse','Electronics',1599),
(117,'Desk Organizer','Stationery',399),
(118,'Router','Electronics',2299),
(119,'Wireless Charger','Electronics',1299),
(120,'Smart Bulb','Home',699);

INSERT INTO orders (order_id, customer_id, order_date) VALUES
(1011, 11, '2023-06-11'),
(1012, 12, '2023-06-12'),
(1013, 13, '2023-06-13'),
(1014, 14, '2023-06-14'),
(1015, 15, '2023-06-15'),
(1016, 16, '2023-06-16'),
(1017, 17, '2023-06-17'),
(1018, 18, '2023-06-18'),
(1019, 19, '2023-06-19'),
(1020, 20, '2023-06-20'),
(1021, 21, '2023-06-21'),
(1022, 22, '2023-06-22'),
(1023, 23, '2023-06-23'),
(1024, 24, '2023-06-24'),
(1025, 25, '2023-06-25'),
(1026, 26, '2023-06-26'),
(1027, 27, '2023-06-27'),
(1028, 28, '2023-06-28'),
(1029, 29, '2023-06-29'),
(1030, 30, '2023-06-30'),

(1031, 31, '2023-07-01'),
(1032, 32, '2023-07-02'),
(1033, 33, '2023-07-03'),
(1034, 34, '2023-07-04'),
(1035, 35, '2023-07-05'),
(1036, 36, '2023-07-06'),
(1037, 37, '2023-07-07'),
(1038, 38, '2023-07-08'),
(1039, 39, '2023-07-09'),
(1040, 40, '2023-07-10'),
(1041, 41, '2023-07-11'),
(1042, 42, '2023-07-12'),
(1043, 43, '2023-07-13'),
(1044, 44, '2023-07-14'),
(1045, 45, '2023-07-15'),
(1046, 46, '2023-07-16'),
(1047, 47, '2023-07-17'),
(1048, 48, '2023-07-18'),
(1049, 49, '2023-07-19'),
(1050, 50, '2023-07-20'),

(1051, 51, '2023-07-21'),
(1052, 52, '2023-07-22'),
(1053, 53, '2023-07-23'),
(1054, 54, '2023-07-24'),
(1055, 55, '2023-07-25'),
(1056, 56, '2023-07-26'),
(1057, 57, '2023-07-27'),
(1058, 58, '2023-07-28'),
(1059, 59, '2023-07-29'),
(1060, 60, '2023-07-30'),
(1061, 61, '2023-07-31'),

(1062, 62, '2023-08-01'),
(1063, 63, '2023-08-02'),
(1064, 64, '2023-08-03'),
(1065, 65, '2023-08-04'),
(1066, 66, '2023-08-05'),
(1067, 67, '2023-08-06'),
(1068, 68, '2023-08-07'),
(1069, 69, '2023-08-08'),
(1070, 70, '2023-08-09'),
(1071, 71, '2023-08-10'),
(1072, 72, '2023-08-11'),
(1073, 73, '2023-08-12'),
(1074, 74, '2023-08-13'),
(1075, 75, '2023-08-14'),
(1076, 76, '2023-08-15'),
(1077, 77, '2023-08-16'),
(1078, 78, '2023-08-17'),
(1079, 79, '2023-08-18'),
(1080, 80, '2023-08-19'),
(1081, 81, '2023-08-20'),
(1082, 82, '2023-08-21'),
(1083, 83, '2023-08-22'),
(1084, 84, '2023-08-23'),
(1085, 85, '2023-08-24'),
(1086, 86, '2023-08-25'),
(1087, 87, '2023-08-26'),
(1088, 88, '2023-08-27'),
(1089, 89, '2023-08-28'),
(1090, 90, '2023-08-29'),
(1091, 91, '2023-08-30'),
(1092, 92, '2023-08-31'),

(1093, 93, '2023-09-01'),
(1094, 94, '2023-09-02'),
(1095, 95, '2023-09-03'),
(1096, 96, '2023-09-04'),
(1097, 97, '2023-09-05'),
(1098, 98, '2023-09-06'),
(1099, 99, '2023-09-07'),
(1100, 100, '2023-09-08'),
(1101, 101, '2023-09-09'),
(1102, 102, '2023-09-10'),
(1103, 103, '2023-09-11'),
(1104, 104, '2023-09-12'),
(1105, 105, '2023-09-13'),
(1106, 106, '2023-09-14'),
(1107, 107, '2023-09-15'),
(1108, 108, '2023-09-16'),
(1109, 109, '2023-09-17'),
(1110, 110, '2023-09-18'),
(1111, 111, '2023-09-19'),
(1112, 112, '2023-09-20'),
(1113, 113, '2023-09-21'),
(1114, 114, '2023-09-22'),
(1115, 115, '2023-09-23'),
(1116, 116, '2023-09-24'),
(1117, 117, '2023-09-25'),
(1118, 118, '2023-09-26'),
(1119, 119, '2023-09-27'),
(1120, 120, '2023-09-28');


INSERT INTO order_items (order_item_id, order_id, product_id, quantity, price) VALUES
(1,1001,101,1,799),
(2,1001,105,2,499),
(3,1002,102,1,1999),
(4,1002,108,3,299),
(5,1003,104,1,3499),
(6,1003,110,1,1599),
(7,1004,107,1,5999),
(8,1004,103,2,1499),
(9,1005,109,1,1299),
(10,1005,111,1,2499),
(11,1006,101,2,799),
(12,1006,106,1,899),
(13,1007,104,1,3499),
(14,1007,108,2,299),
(15,1008,102,1,1999),
(16,1008,110,1,1599),
(17,1009,103,2,1499),
(18,1009,107,1,5999),
(19,1010,105,1,499),
(20,1010,111,1,2499),
(21,1011,101,1,799),
(22,1011,109,2,1299),
(23,1012,102,1,1999),
(24,1012,108,3,299),
(25,1013,104,1,3499),
(26,1013,110,1,1599),
(27,1014,107,1,5999),
(28,1014,103,2,1499),
(29,1015,105,1,499),
(30,1015,111,1,2499),
(31,1016,101,2,799),
(32,1016,106,1,899),
(33,1017,104,1,3499),
(34,1017,108,2,299),
(35,1018,102,1,1999),
(36,1018,110,1,1599),
(37,1019,103,2,1499),
(38,1019,107,1,5999),
(39,1020,105,1,499),
(40,1020,111,1,2499),
(41,1021,101,1,799),
(42,1021,109,2,1299),
(43,1022,102,1,1999),
(44,1022,108,3,299),
(45,1023,104,1,3499),
(46,1023,110,1,1599),
(47,1024,107,1,5999),
(48,1024,103,2,1499),
(49,1025,105,1,499),
(50,1025,111,1,2499),
(51,1026,101,2,799),
(52,1026,106,1,899),
(53,1027,104,1,3499),
(54,1027,108,2,299),
(55,1028,102,1,1999),
(56,1028,110,1,1599),
(57,1029,103,2,1499),
(58,1029,107,1,5999),
(59,1030,105,1,499),
(60,1030,111,1,2499),
(61,1031,101,1,799),
(62,1031,105,2,499),
(63,1032,102,1,1999),
(64,1032,108,3,299),
(65,1033,104,1,3499),
(66,1033,110,1,1599),
(67,1034,107,1,5999),
(68,1034,103,2,1499),
(69,1035,109,1,1299),
(70,1035,111,1,2499),
(71,1036,101,2,799),
(72,1036,106,1,899),
(73,1037,104,1,3499),
(74,1037,108,2,299),
(75,1038,102,1,1999),
(76,1038,110,1,1599),
(77,1039,103,2,1499),
(78,1039,107,1,5999),
(79,1040,105,1,499),
(80,1040,111,1,2499),
(81,1041,101,1,799),
(82,1041,109,2,1299),
(83,1042,102,1,1999),
(84,1042,108,3,299),
(85,1043,104,1,3499),
(86,1043,110,1,1599),
(87,1044,107,1,5999),
(88,1044,103,2,1499),
(89,1045,105,1,499),
(90,1045,111,1,2499),
(91,1046,101,2,799),
(92,1046,106,1,899),
(93,1047,104,1,3499),
(94,1047,108,2,299),
(95,1048,102,1,1999),
(96,1048,110,1,1599),
(97,1049,103,2,1499),
(98,1049,107,1,5999),
(99,1050,105,1,499),
(100,1050,111,1,2499),
(101,1051,101,1,799),
(102,1051,109,2,1299),
(103,1052,102,1,1999),
(104,1052,108,3,299),
(105,1053,104,1,3499),
(106,1053,110,1,1599),
(107,1054,107,1,5999),
(108,1054,103,2,1499),
(109,1055,105,1,499),
(110,1055,111,1,2499),

(111,1056,101,2,799),
(112,1056,106,1,899),
(113,1057,104,1,3499),
(114,1057,108,2,299),
(115,1058,102,1,1999),
(116,1058,110,1,1599),
(117,1059,103,2,1499),
(118,1059,107,1,5999),
(119,1060,105,1,499),
(120,1060,111,1,2499),
(121,1061,101,1,799),
(122,1061,105,2,499),
(123,1062,102,1,1999),
(124,1062,108,3,299),
(125,1063,104,1,3499),
(126,1063,110,1,1599),
(127,1064,107,1,5999),
(128,1064,103,2,1499),
(129,1065,109,1,1299),
(130,1065,111,1,2499),
(131,1066,101,2,799),
(132,1066,106,1,899),
(133,1067,104,1,3499),
(134,1067,108,2,299),
(135,1068,102,1,1999),
(136,1068,110,1,1599),
(137,1069,103,2,1499),
(138,1069,107,1,5999),
(139,1070,105,1,499),
(140,1070,111,1,2499),
(141,1071,101,1,799),
(142,1071,109,2,1299),
(143,1072,102,1,1999),
(144,1072,108,3,299),
(145,1073,104,1,3499),
(146,1073,110,1,1599),
(147,1074,107,1,5999),
(148,1074,103,2,1499),
(149,1075,105,1,499),
(150,1075,111,1,2499),
(151,1076,101,2,799),
(152,1076,106,1,899),
(153,1077,104,1,3499),
(154,1077,108,2,299),
(155,1078,102,1,1999),
(156,1078,110,1,1599),
(157,1079,103,2,1499),
(158,1079,107,1,5999),
(159,1080,105,1,499),
(160,1080,111,1,2499),
(161,1081,101,1,799),
(162,1081,109,2,1299),
(163,1082,102,1,1999),
(164,1082,108,3,299),
(165,1083,104,1,3499),
(166,1083,110,1,1599),
(167,1084,107,1,5999),
(168,1084,103,2,1499),
(169,1085,105,1,499),
(170,1085,111,1,2499),
(171,1086,101,2,799),
(172,1086,106,1,899),
(173,1087,104,1,3499),
(174,1087,108,2,299),
(175,1088,102,1,1999),
(176,1088,110,1,1599),
(177,1089,103,2,1499),
(178,1089,107,1,5999),
(179,1090,105,1,499),
(180,1090,111,1,2499),
(181,1091,101,1,799),
(182,1091,109,2,1299),
(183,1092,102,1,1999),
(184,1092,108,3,299),
(185,1093,104,1,3499),
(186,1093,110,1,1599),
(187,1094,107,1,5999),
(188,1094,103,2,1499),
(189,1095,105,1,499),
(190,1095,111,1,2499),
(191,1096,101,2,799),
(192,1096,106,1,899),
(193,1097,104,1,3499),
(194,1097,108,2,299),
(195,1098,102,1,1999),
(196,1098,110,1,1599),
(197,1099,103,2,1499),
(198,1099,107,1,5999),
(199,1100,105,1,499),
(200,1100,111,1,2499),
(201,1101,101,1,799),
(202,1101,109,2,1299),
(203,1102,102,1,1999),
(204,1102,108,3,299),
(205,1103,104,1,3499),
(206,1103,110,1,1599),
(207,1104,107,1,5999),
(208,1104,103,2,1499),
(209,1105,105,1,499),
(210,1105,111,1,2499),
(211,1106,101,2,799),
(212,1106,106,1,899),
(213,1107,104,1,3499),
(214,1107,108,2,299),
(215,1108,102,1,1999),
(216,1108,110,1,1599),
(217,1109,103,2,1499),
(218,1109,107,1,5999),
(219,1110,105,1,499),
(220,1110,111,1,2499),
(221,1111,101,1,799),
(222,1111,109,2,1299),
(223,1112,102,1,1999),
(224,1112,108,3,299),
(225,1113,104,1,3499),
(226,1113,110,1,1599),
(227,1114,107,1,5999),
(228,1114,103,2,1499),
(229,1115,105,1,499),
(230,1115,111,1,2499),
(231,1116,101,2,799),
(232,1116,106,1,899),
(233,1117,104,1,3499),
(234,1117,108,2,299),
(235,1118,102,1,1999),
(236,1118,110,1,1599),
(237,1119,103,2,1499),
(238,1119,107,1,5999),
(239,1120,105,1,499),
(240,1120,111,1,2499),
(241,1121,101,1,799),
(242,1121,109,2,1299),
(243,1122,102,1,1999),
(244,1122,108,3,299),
(245,1123,104,1,3499),
(246,1123,110,1,1599),
(247,1124,107,1,5999),
(248,1124,103,2,1499),
(249,1125,105,1,499),
(250,1125,111,1,2499),
(251,1126,101,2,799),
(252,1126,106,1,899),
(253,1127,104,1,3499),
(254,1127,108,2,299),
(255,1128,102,1,1999),
(256,1128,110,1,1599),
(257,1129,103,2,1499),
(258,1129,107,1,5999),
(259,1130,105,1,499),
(260,1130,111,1,2499),
(261,1131,101,1,799),
(262,1131,109,2,1299),
(263,1132,102,1,1999),
(264,1132,108,3,299),
(265,1133,104,1,3499),
(266,1133,110,1,1599),
(267,1134,107,1,5999),
(268,1134,103,2,1499),
(269,1135,105,1,499),
(270,1135,111,1,2499),
(271,1136,101,2,799),
(272,1136,106,1,899),
(273,1137,104,1,3499),
(274,1137,108,2,299),
(275,1138,102,1,1999),
(276,1138,110,1,1599),
(277,1139,103,2,1499),
(278,1139,107,1,5999),
(279,1140,105,1,499),
(280,1140,111,1,2499),
(281,1141,101,1,799),
(282,1141,109,2,1299),
(283,1142,102,1,1999),
(284,1142,108,3,299),
(285,1143,104,1,3499),
(286,1143,110,1,1599),
(287,1144,107,1,5999),
(288,1144,103,2,1499),
(289,1145,105,1,499),
(290,1145,111,1,2499),
(291,1146,101,2,799),
(292,1146,106,1,899),
(293,1147,104,1,3499),
(294,1147,108,2,299),
(295,1148,102,1,1999),
(296,1148,110,1,1599),
(297,1149,103,2,1499),
(298,1149,107,1,5999),
(299,1150,105,1,499),
(300,1150,111,1,2499);

INSERT INTO payments (payment_id, order_id, payment_mode, payment_status) VALUES
(1,1001,'Credit Card','Completed'),
(2,1002,'UPI','Completed'),
(3,1003,'Debit Card','Completed'),
(4,1004,'Net Banking','Completed'),
(5,1005,'Cash on Delivery','Pending'),

(6,1006,'UPI','Completed'),
(7,1007,'Credit Card','Completed'),
(8,1008,'Debit Card','Failed'),
(9,1009,'UPI','Completed'),
(10,1010,'Net Banking','Completed'),

(11,1011,'Credit Card','Completed'),
(12,1012,'UPI','Completed'),
(13,1013,'Debit Card','Completed'),
(14,1014,'Cash on Delivery','Pending'),
(15,1015,'Net Banking','Completed'),

(16,1016,'UPI','Completed'),
(17,1017,'Credit Card','Failed'),
(18,1018,'Debit Card','Completed'),
(19,1019,'UPI','Completed'),
(20,1020,'Cash on Delivery','Pending'),

(21,1021,'Credit Card','Completed'),
(22,1022,'UPI','Completed'),
(23,1023,'Debit Card','Completed'),
(24,1024,'Net Banking','Completed'),
(25,1025,'Cash on Delivery','Pending'),

(26,1026,'UPI','Completed'),
(27,1027,'Credit Card','Completed'),
(28,1028,'Debit Card','Failed'),
(29,1029,'UPI','Completed'),
(30,1030,'Net Banking','Completed'),

(31,1031,'Credit Card','Completed'),
(32,1032,'UPI','Completed'),
(33,1033,'Debit Card','Completed'),
(34,1034,'Cash on Delivery','Pending'),
(35,1035,'Net Banking','Completed'),

(36,1036,'UPI','Completed'),
(37,1037,'Credit Card','Completed'),
(38,1038,'Debit Card','Failed'),
(39,1039,'UPI','Completed'),
(40,1040,'Cash on Delivery','Pending');


SELECT SUM(price * quantity) AS total_revenue
FROM order_items;



SELECT MONTH(o.order_date) AS month,
       SUM(oi.price * oi.quantity) AS revenue
FROM orders o
JOIN order_items oi ON o.order_id = oi.order_id
GROUP BY MONTH(o.order_date)
ORDER BY month;




SELECT p.product_name, SUM(oi.quantity) AS total_sold
FROM order_items oi
JOIN products p ON oi.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_sold DESC
LIMIT 5;




SELECT c.customer_name, SUM(oi.price * oi.quantity) AS total_spent
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
JOIN order_items oi ON o.order_id = oi.order_id
GROUP BY c.customer_name
ORDER BY total_spent DESC;



SELECT p.category, SUM(oi.price * oi.quantity) AS revenue
FROM products p
JOIN order_items oi ON p.product_id = oi.product_id
GROUP BY p.category;



SELECT customer_id, COUNT(order_id) AS total_orders
FROM orders
GROUP BY customer_id
HAVING COUNT(order_id) > 1;



SELECT payment_mode, COUNT(*) AS total_transactions
FROM payments
GROUP BY payment_mode;



SELECT customer_id,
       SUM(price * quantity) AS total_spent,
       RANK() OVER (ORDER BY SUM(price * quantity) DESC) AS rank_no
FROM orders o
JOIN order_items oi ON o.order_id = oi.order_id
GROUP BY customer_id;
